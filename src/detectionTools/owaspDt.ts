import Path from 'path';
import { DetectionToolFunction } from '../interfaces/types';

const func: DetectionToolFunction = (project, projectPath, resultsPath, packageJsonDirs) => {
    let cmd = ':';
    for (let i = 0; i < packageJsonDirs.length; ++i) {
        const dependencyTrackBomsPath = Path.join(resultsPath, `dependencyTrackBom${i}.json`);
        const dir = packageJsonDirs[i];
        cmd = `${cmd}; cd ${dir} && cyclonedx-bom --include-dev -o ${dependencyTrackBomsPath}`;
    }
    return cmd;
}

export default func;
