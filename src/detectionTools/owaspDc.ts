import { spawn } from 'child_process';
import { DetectionToolFunction } from '../interfaces/types';
import { handleErrorsAndPromisify } from './util';

const TOOL_NAME = 'OWASP DC';

const func: DetectionToolFunction = (project, projectPath, resultsPath, packageJsonDirs) => {
    const cmd = `dependency-check.sh --project ${project.name} -o ${resultsPath} -f JSON -s .`;
    const child = spawn(cmd, { cwd: projectPath, shell: true });
    return handleErrorsAndPromisify(child, project, TOOL_NAME);
}

export default func;
